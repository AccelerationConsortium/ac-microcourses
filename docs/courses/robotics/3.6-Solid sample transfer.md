
(3.6-orientation)=
# ðŸ§© 3.6 Solid Sample Transfer

```{contents}
:depth: 3
```

## ðŸ”° Tutorial

In this module, you will develop software to:
1. Use **ROS**, **AprilTags**, a multi-axis robot, and a workflow orchestration platform to perform solid sample transfer tasks.
2. Coordinate robotic movements using a multi-axis robot for accurate solid sample positioning.

### Workflow Orchestration

Workflow orchestration platforms help manage complex tasks and processes by coordinating the flow of operations, especially in robotic and laboratory settings. **Prefect** is one such orchestration tool used for scheduling and automating tasks in workflows. This is useful when performing solid sample transfers, as the process often requires coordinating multiple devices, sensors, and tasks.

### Bill of Materials

- [MyCobot Pi - World's Smallest and Lightest Six-Axis Collaborative Robot](https://shop.elephantrobotics.com/en-ca/collections/mycobot-280/products/mycobot-pi-worlds-smallest-and-lightest-six-axis-collaborative-robot)  
  A compact and versatile six-axis robot suitable for performing precise sample transfer tasks.

- [Camera Flange 2.0](https://shop.elephantrobotics.com/en-ca/collections/camera-modules/products/camera-flange-2-0)  
  A camera module attachment for enhanced visual feedback during sample transfer operations.

- [Adaptive Gripper](https://shop.elephantrobotics.com/en-ca/collections/grippers/products/adaptive-gripper)  
  A flexible gripper designed for secure handling and transfer of solid samples during automated processes.

- [G-Shape Base 2.0](https://shop.elephantrobotics.com/en-ca/collections/fixed-bases/products/g-shape-base-2-0)  
  A stable base for mounting the MyCobot robot, ensuring precision during robotic movements and sample handling.

- [Prefect](https://www.prefect.io/)  
  A workflow orchestration tool to manage and coordinate asynchronous tasks during the sample transfer process.

- [AprilTags Python Library](https://pypi.org/project/apriltag/)  
  Used for spatial referencing and tracking of sample containers using AprilTags for accurate positioning.

- [ROS Noetic Ninjemys](http://wiki.ros.org/noetic/Installation) (for Ubuntu 20.04)  
  A robotic framework used for controlling the multi-axis robot during the sample transfer process.

- [ROS 2 Foxy Fitzroy](https://docs.ros.org/en/foxy/Installation.html) (for newer ROS 2 applications)  
  A newer ROS version that can be used for more advanced robotic control and integration with workflow orchestration.

- [Multi-Axis Robot](https://shop.elephantrobotics.com/en-ca/collections/mycobot-280/products/mycobot-pi-worlds-smallest-and-lightest-six-axis-collaborative-robot)  
  A robotic arm designed for executing precise sample movements across multiple axes.

- [TurtleBot3 Burger](https://emanual.robotis.com/docs/en/platform/turtlebot3/overview/)  
  An auxiliary robot for moving samples or collaborating with the multi-axis robot in complex workflows.

- [Raspberry Pi 4 Model B](https://www.raspberrypi.org/products/raspberry-pi-4-model-b/)  
  A microcontroller for running ROS and interfacing with the multi-axis robot and peripheral devices.

- USB-A to micro USB-B cable:  
  For connecting the Raspberry Pi and other peripheral devices for power and data transfer.

- SD Card with Raspbian OS: 
  Pre-installed with Raspbian OS for quick setup of the Raspberry Pi during integration with the robot.

#### Documentation

- [MyCobot Pi Documentation](https://docs.elephantrobotics.com/docs/gitbook-en/2-serialproduct/2.1-280/2.1.2-PI.html)  
  A guide for setting up and controlling the MyCobot robot for sample transfer tasks.

- [Gripper Control via Python](https://docs.elephantrobotics.com/docs/gitbook-en/7-ApplicationBasePython/7.5_gripper.html)  
  Detailed instructions for using Python to control the adaptive gripper during the sample transfer process.

- [TurtleBot3 Documentation](https://emanual.robotis.com/docs/en/platform/turtlebot3/overview/)  
  Official documentation for using the TurtleBot3 in conjunction with the multi-axis robot for automated workflows.

### Notes
These materials enable the setup and execution of a solid sample transfer process, utilizing ROS, AprilTags, and a multi-axis robot for precision control. Prefect orchestrates the workflow, allowing for asynchronous task management in a highly automated and efficient manner. This setup is ideal for educational and research environments that require robust and flexible sample handling solutions.

#### Demo

âœ… Read [Prefect Documentation](https://docs.prefect.io/core/)

âœ… Watch [Workflow Orchestration with Prefect](https://www.youtube.com/watch?v=AjYHBwH2Mtc&pp=ygUjV29ya2Zsb3cgT3JjaGVzdHJhdGlvbiB3aXRoIFByZWZlY3Q%3D)

You will use **Prefect** to manage tasks such as moving the robot, detecting samples, and transferring them. The following code demonstrates how to orchestrate these tasks using **Prefect**:

```python
from prefect import task, Flow

@task
def move_robot_to_position(x, y, z):
    print(f"Moving robot to position ({x}, {y}, {z})...")

@task
def grab_sample():
    print("Grabbing the solid sample...")

@task
def transfer_sample_to_new_position(x, y, z):
    print(f"Transferring sample to position ({x}, {y}, {z})...")

with Flow("Solid Sample Transfer") as flow:
    move_robot_to_position(10, 20, 30)
    grab_sample()
    transfer_sample_to_new_position(50, 60, 70)

flow.run()
```

This simple workflow orchestrates the robotâ€™s movement and solid sample transfer tasks. In practice, this can be integrated with a robotic arm and **AprilTags** for accurate spatial referencing.

---

### ROS and AprilTags

**ROS** is a widely-used open-source framework that provides libraries and tools to help developers build robot applications. In this module, you'll use **ROS** in conjunction with **AprilTags** to identify and track the location of solid samples. **AprilTags** can be placed on or near solid samples for accurate identification, helping the robot to perform tasks like picking and placing samples.

#### Bill of Materials

- [Raspberry Pi Camera Module](https://www.raspberrypi.org/products/camera-module-v2/)

#### Demo

âœ… Watch [ROS and AprilTags Integration](https://www.youtube.com/watch?v=A7NRBvEDK2M&ab_channel=TheConstruct)

```bash
# Launch ROS and start AprilTag detection
roslaunch apriltag_ros continuous_detection.launch

# Publish detected tag coordinates to the robot
rostopic pub /cmd_pos geometry_msgs/Point "x: 10.0 y: 20.0 z: 30.0"
```

This setup allows the robot to detect **AprilTags** using the camera and adjust its position to transfer solid samples based on tag locations.

---

### Multi-Axis Robotics

A multi-axis robot, such as a 6-axis robotic arm, can perform complex movements for handling solid samples with precision. Using **ROS** and integrating workflow orchestration via **Prefect** ensures that the robot's movements are coordinated efficiently with the detected **AprilTags**.

#### Demo

âœ… Watch [What is a 6-Axis Robot?](https://www.youtube.com/watch?v=UxO0xqvvGcM&pp=ygUcNi1BeGlzIFJvYm90aWMgQXJtIGluIEFjdGlvbg%3D%3D)

You can control the robotic arm using **ROS** commands:

```bash
# Command the multi-axis robot to move to a specific position
rosrun robot_movement_interface move_robot_to_position.py --x 10 --y 20 --z 30
```

The **multi-axis robot** can then follow the precise coordinates based on **AprilTag** detection and transfer solid samples between different positions.

---

## ðŸš€ Quiz

::::{tab-set}
:sync-group: category

:::{tab-item} Sp/Su 2024
:sync: sp2024

[Quiz URL]
:::

::::

---

## ðŸ“„ Assignment

Create a script that uses **ROS**, **AprilTags**, and a multi-axis robot to perform a solid sample transfer. Your task is to:
1. **Use ROS** to move the multi-axis robot to specific positions.
2. **Detect solid samples** using **AprilTags**.
3. **Orchestrate the workflow** using **Prefect** to manage the robot's tasks, such as moving to the sample, picking it up, and transferring it to a new location.

Example tasks:
1. Write a script to detect **AprilTags** and use their coordinates to instruct the robot's movement.
2. Create a workflow using **Prefect** to automate sample transfer from one location to another.
3. Test your system with a solid sample and verify its accuracy.


